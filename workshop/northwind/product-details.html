<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/water.css@2/out/water.css">
    <style>
        dl {
            border: 1px dashed var(--border);
            padding: 1.2em;
        }

        dt {
            float: left;
            clear: left;
            width: 150px;
            text-align: right;
            font-weight: bold;
            color: var(--form-text);
        }

        dt::after {
            content: ":";
        }

        dd {
            margin: 0 0 0 160px;
            padding: 0 0 0.5em 0;
        }
    </style>
</head>

<body>
    <nav>
        <a href="./index.html">Home</a> |
        <a href="./products.html">Products</a>
    </nav>
    <h1>productName</h1>
    <dl id="product-details">
        <dt>Price</dt>
        <dd>unitPrice</dd>
        <dt>How Many Left</dt>
        <dd>unitsInStock</dd>
        <dt>Category</dt>
        <dd>categoryId</dd>
        <dt>Supplier</dt>
        <dd>supplier</dd>
        <dt>Discontinued</dt>
        <dd>discontinued</dd>
        <dt>Product Number</dt>
        <dd>productId</dd>
    </dl>

</body>
<script>
    function getProductId() {
        let parameters = new URLSearchParams(location.search);
        return parameters.get("id");
    }

    function loadProduct(productId) {
        return fetch(`http://localhost:8081/api/products/${productId}`)
            .then((response) => response.json())
    }

    function fillProductDetails(product) {
        const productDescriptionList = document.querySelector("#product-details");
        document.querySelector("h1").innerText = product.productName;
        const detailDefinitions = productDescriptionList.querySelectorAll("dd");
        detailDefinitions[0].innerText = Number(product.unitPrice).toLocaleString('en-US', {
            style: 'currency',
            currency: 'USD',
        });
        detailDefinitions[1].innerText = product.unitsInStock;
        detailDefinitions[2].innerText = product.categoryId;
        detailDefinitions[3].innerText = product.supplier;
        detailDefinitions[4].innerText = Boolean(product.discontinued === "true") ? "Yes" : "No";
        detailDefinitions[5].innerText = product.productId;

    }

    window.onload = () => {
        loadProduct(getProductId()).then(product => fillProductDetails(product))
    }

</script>

</html>